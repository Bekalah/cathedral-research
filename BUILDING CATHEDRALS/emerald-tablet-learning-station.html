<!DOCTYPE html>
<!doctype html>
<html lang="en" data-codex="144:99" data-realm="chapel" data-chapel="emerald-tablet" data-nd-safe="true">
    <head>
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:;">
        <meta charset="utf-8" />
        <title>‚ú¶ Emerald Tablet ‚Äî Codex 144:99 Learning Station</title>
            <meta name="viewport" content="width=device-width, initial-scale=1" />
            <meta name="description" content="Emerald Tablet of Hermes integrated as meta-law and instructions for the Cosmogenesis Learning Engine. ND-safe, no autoplay, museum-grade." />
            <style>
                :root {
                --ink: #111; --wash: #f7f7f8; --gold: #c6a767; --accent: #5b4b8a; --stone: #222; --halo: #eae6df;
                --ring: rgba(198,167,103,0.22); --veil: rgba(0,0,0,0.05);
                --radius: 14px; --gap: 14px; --grid: minmax(260px, 1fr);
                font-synthesis-weight: none;
                }
                body{margin:0;background:var(--wash);color:var(--ink);font:16px/1.6 ui-serif, "EB Garamond", Georgia, serif;}
                .wrap{max-width:1100px;margin:auto;padding:24px;}
                header{display:grid;gap:8px;margin:12px 0 22px;padding:18px;border:1px solid var(--ring);border-radius:var(--radius);background:linear-gradient(0deg,var(--halo),#fff);}
                h1{font-size:1.9rem;letter-spacing:.2px;margin:0}
                .meta{display:flex;flex-wrap:wrap;gap:10px;font-size:.9rem;color:#444}
                .chip{padding:4px 10px;border-radius:999px;border:1px solid var(--ring);background:#fff}
                .grid{display:grid;grid-template-columns:repeat(auto-fit,var(--grid));gap:var(--gap)}
                section.card{background:#fff;border:1px solid var(--ring);border-radius:var(--radius);padding:16px 16px 18px}
                h2{margin:0 0 8px;font-size:1.2rem;letter-spacing:.2px}
                h3{margin:10px 0 4px;font-size:1rem}
                p,li{margin:8px 0}
                .mono{font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;font-size:.95rem}
                .vesica{position:relative;aspect-ratio:2.2/1;border-radius:999px;background:
                radial-gradient(120% 100% at 25% 50%, transparent 52%, var(--ring) 53% 54%, transparent 55%),
                radial-gradient(120% 100% at 75% 50%, transparent 52%, var(--ring) 53% 54%, transparent 55%);}
                .row{display:flex;flex-wrap:wrap;gap:10px}
                button,select{appearance:none;background:#fff;border:1px solid var(--stone);border-radius:10px;padding:8px 12px;font:inherit;cursor:pointer}
                button[aria-pressed="true"]{border-color:var(--gold);box-shadow:0 0 0 2px var(--ring) inset}
                .note{font-size:.9rem;color:#555}
                .table{border-collapse:separate;border-spacing:0;width:100%;font-size:.95rem}
                .table th,.table td{border:1px solid var(--ring);padding:10px 12px;vertical-align:top}
                .table th{background:#fdfbf6}
                details{border:1px dashed var(--ring);border-radius:12px;padding:10px 12px;background:#fff}
                details[open]{background:linear-gradient(0deg,#fff, #faf7ef)}
                summary{cursor:pointer}
                .kbd{font:600 .85rem ui-monospace, monospace;padding:2px 6px;border:1px solid var(--ring);border-radius:6px;background:#fff}
                .foot{margin-top:18px;font-size:.85rem;color:#555}
                /* Octagram Node Selector */
                .octagram-grid {
                display: grid;
                grid-template-columns: repeat(4, 1fr);
                gap: 12px;
                margin: 16px 0;
                }
                .node-btn {
                padding: 12px;
                text-align: center;
                font-size: 0.85rem;
                min-height: 80px;
                display: flex;
                flex-direction: column;
                justify-content: center;
                transition: all 0.3s ease;
                }
                .node-btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(198,167,103,0.3);
                }
                .node-btn[aria-pressed="true"] {
                background: var(--gold);
                color: white;
                border-color: var(--gold);
                }
                .node-title {
                font-weight: 600;
                margin-bottom: 4px;
                }
                .node-archetype {
                font-size: 0.75rem;
                opacity: 0.8;
                }
                /* Tools Panel */
                .tools-panel {
                background: #faf7ef;
                border-radius: 12px;
                padding: 16px;
                margin-top: 16px;
                }
                .tool-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
                gap: 8px;
                margin-top: 12px;
                }
                .tool-btn {
                padding: 8px;
                font-size: 0.8rem;
                text-align: center;
                opacity: 0.7;
                transition: opacity 0.3s ease;
                }
                .tool-btn:hover {
                opacity: 1;
                }
                .tool-btn[data-available="true"] {
                opacity: 1;
                background: linear-gradient(135deg, var(--gold), var(--accent));
                color: white;
                border-color: transparent;
                }
            </style>
        </head>
        <body>
            <div class="wrap" id="root">
                <header>
                    <h1>‚ú¶ Emerald Tablet ‚Äî Learning Station</h1>
                        <div class="meta" role="list">
                            <div class="chip" role="listitem">Codex 144:99</div>
                                <div class="chip" role="listitem">ND-safe (no autoplay)</div>
                                    <div class="chip" role="listitem">Above ‚áÑ Below Mirror</div>
                                        <div class="chip" role="listitem">Solve et Coagula Modes</div>
                                        </div>
                                    </header>
                                    <section class="card" aria-labelledby="law">
                                        <h2 id="law">Meta-Law (The One Thing)</h2>
                                            <p>
                                                <em>"That which is above is like to that which is below, to accomplish the miracles of the One Thing."</em>
                                                </p>
                                                <ul>
                                                    <li>
                                                        <strong>Directive:</strong> Every scene, node, and spiral must declare its <span class="mono">above</span> view (overview) and <span class="mono">below</span> view (detail). Rendering and data should mirror micro/macro.</li>
                                                            <li>
                                                                <strong>Guard:</strong> <span class="mono">c144.guard.js</span> enforces singularity (no duplicate egregores), ensures stable init across chapels, and broadcasts mode changes.</li>
                                                                </ul>
                                                                <div class="vesica" aria-hidden="true">
                                                                </div>
                                                                <p class="note">Embed geometry quietly. No flashing, no strobe. Palette binds to stylepacks (wash/ink/gold) if present.</p>
                                                                </section>
                                                                <div class="grid" aria-label="Controls">
                                                                    <section class="card" aria-labelledby="tablet-modes">
                                                                        <h2 id="tablet-modes">Tablet Modes</h2>
                                                                            <p class="note">Map verses ‚Üí engine behavior. Toggle sends events only on user action.</p>
                                                                                <div class="row" role="group" aria-label="Select Tablet Mode">
                                                                                    <button id="btn-solve" data-mode="solve" aria-pressed="false" title="Separate the subtle from the gross">Solve</button>
                                                                                        <button id="btn-coagula" data-mode="coagula" aria-pressed="false" title="Recombine with ingenuity">Coagula</button>
                                                                                            <button id="btn-spiral" data-mode="spiral" aria-pressed="true" title="Ascend/descend the ladder">Spiral</button>
                                                                                                <button id="btn-revelation" data-mode="revelation" aria-pressed="false" title="Show forth; export">Revelation</button>
                                                                                                </div>
                                                                                                <ul>
                                                                                                    <li>
                                                                                                        <strong>Solve:</strong> filters, parsing, separation pipelines.</li>
                                                                                                            <li>
                                                                                                                <strong>Coagula:</strong> fusion lab, blending, synthesis.</li>
                                                                                                                    <li>
                                                                                                                        <strong>Spiral:</strong> nodal navigation (up = abstract, down = embody).</li>
                                                                                                                            <li>
                                                                                                                                <strong>Revelation:</strong> render/export (SVG/PNG), provenance JSON.</li>
                                                                                                                                </ul>
                                                                                                                            </section>
                                                                                                                            <section class="card" aria-labelledby="elements">
                                                                                                                                <h2 id="elements">Elemental Data Modes</h2>
                                                                                                                                    <p>
                                                                                                                                        <em>"The Sun is its father, the Moon its mother, the Wind hath carried it in its belly, the Earth is its nurse."</em>
                                                                                                                                        </p>
                                                                                                                                        <div class="row" role="group" aria-label="Select Element">
                                                                                                                                            <button id="el-sun" data-element="sun" aria-pressed="true">Sun ¬∑ Fire (render/light)</button>
                                                                                                                                                <button id="el-moon" data-element="moon" aria-pressed="false">Moon ¬∑ Water (memory/archive)</button>
                                                                                                                                                    <button id="el-wind" data-element="wind" aria-pressed="false">Wind ¬∑ Air (network/input)</button>
                                                                                                                                                        <button id="el-earth" data-element="earth" aria-pressed="false">Earth ¬∑ Earth (files/provenance)</button>
                                                                                                                                                        </div>
                                                                                                                                                        <p class="note">Each chapel declares an element. Engines can theme behaviors (IO, caching, storage) from this state.</p>
                                                                                                                                                        </section>
                                                                                                                                                    </div>
                                                                                                                                                    <section class="card" aria-labelledby="octagram">
                                                                                                                                                        <h2 id="octagram">Octagram Master Nodes</h2>
                                                                                                                                                            <p class="note">Select a Master Archetype to access their tools, chapels, and pathworking systems.</p>
                                                                                                                                                                <div class="octagram-grid" role="group" aria-label="Select Master Archetype">
                                                                                                                                                                    <button class="node-btn" data-node="fool" aria-pressed="true">
                                                                                                                                                                        <div class="node-title">üåü Fool</div>
                                                                                                                                                                            <div class="node-archetype">Rebecca Respawn</div>
                                                                                                                                                                            </button>
                                                                                                                                                                            <button class="node-btn" data-node="magician" aria-pressed="false">
                                                                                                                                                                                <div class="node-title">üåç Magician</div>
                                                                                                                                                                                    <div class="node-archetype">Agrippa</div>
                                                                                                                                                                                    </button>
                                                                                                                                                                                    <button class="node-btn" data-node="priestess" aria-pressed="false">
                                                                                                                                                                                        <div class="node-title">üåô High Priestess</div>
                                                                                                                                                                                            <div class="node-archetype">Dion Fortune</div>
                                                                                                                                                                                            </button>
                                                                                                                                                                                            <button class="node-btn" data-node="justice" aria-pressed="false">
                                                                                                                                                                                                <div class="node-title">‚öñÔ∏è Justice</div>
                                                                                                                                                                                                    <div class="node-archetype">Stephen Skinner</div>
                                                                                                                                                                                                    </button>
                                                                                                                                                                                                    <button class="node-btn" data-node="hanged" aria-pressed="false">
                                                                                                                                                                                                        <div class="node-title">ü™û Hanged Man</div>
                                                                                                                                                                                                            <div class="node-archetype">Frater Achad</div>
                                                                                                                                                                                                            </button>
                                                                                                                                                                                                            <button class="node-btn" data-node="temperance" aria-pressed="false">
                                                                                                                                                                                                                <div class="node-title">üåà Temperance</div>
                                                                                                                                                                                                                    <div class="node-archetype">Paul Foster Case</div>
                                                                                                                                                                                                                    </button>
                                                                                                                                                                                                                    <button class="node-btn" data-node="tower" aria-pressed="false">
                                                                                                                                                                                                                        <div class="node-title">‚ö° Tower</div>
                                                                                                                                                                                                                            <div class="node-archetype">Aleister Crowley</div>
                                                                                                                                                                                                                            </button>
                                                                                                                                                                                                                            <button class="node-btn" data-node="star" aria-pressed="false">
                                                                                                                                                                                                                                <div class="node-title">‚≠ê Star</div>
                                                                                                                                                                                                                                    <div class="node-archetype">Tara Lineage</div>
                                                                                                                                                                                                                                    </button>
                                                                                                                                                                                                                                </div>
                                                                                                                                                                                                                                <div class="tools-panel" id="tools-panel">
                                                                                                                                                                                                                                    <h3>Available Tools for <span id="current-archetype">Rebecca Respawn</span>
                                                                                                                                                                                                                                    </h3>
                                                                                                                                                                                                                                    <div class="tool-grid" id="tool-grid">
                                                                                                                                                                                                                                        <button class="tool-btn" data-tool="manifestation_engine" data-available="true">Manifestation Engine</button>
                                                                                                                                                                                                                                            <button class="tool-btn" data-tool="respawn_portal" data-available="true">Respawn Portal</button>
                                                                                                                                                                                                                                                <button class="tool-btn" data-tool="spiral_navigator" data-available="true">Spiral Navigator</button>
                                                                                                                                                                                                                                                </div>
                                                                                                                                                                                                                                                <p class="note" id="tool-description">The Fool's tools focus on creative respawn, learning through mistakes, and unlimited curiosity exploration.</p>
                                                                                                                                                                                                                                                </div>
                                                                                                                                                                                                                                            </section>
                                                                                                                                                                                                                                            <details>
                                                                                                                                                                                                                                                <summary>
                                                                                                                                                                                                                                                    <strong>Emerald Tablet Verses</strong> ‚Äî Full Reference</summary>
                                                                                                                                                                                                                                                        <table class="table" id="tablet-table">
                                                                                                                                                                                                                                                            <thead>
                                                                                                                                                                                                                                                                <tr>
                                                                                                                                                                                                                                                                    <th>Verse</th>
                                                                                                                                                                                                                                                                        <th>Text</th>
                                                                                                                                                                                                                                                                            <th>Implementation</th>
                                                                                                                                                                                                                                                                            </tr>
                                                                                                                                                                                                                                                                        </thead>
                                                                                                                                                                                                                                                                        <tbody>
                                                                                                                                                                                                                                                                            <tr>
                                                                                                                                                                                                                                                                                <td>1</td>
                                                                                                                                                                                                                                                                                    <td>True, without falsehood, certain and most true.</td>
                                                                                                                                                                                                                                                                                        <td>Provenance checksum, truth validation</td>
                                                                                                                                                                                                                                                                                        </tr>
                                                                                                                                                                                                                                                                                        <tr>
                                                                                                                                                                                                                                                                                            <td>2</td>
                                                                                                                                                                                                                                                                                                <td>That which is above is like to that which is below...</td>
                                                                                                                                                                                                                                                                                                    <td>Mirror layouts: overview/detail lattice</td>
                                                                                                                                                                                                                                                                                                    </tr>
                                                                                                                                                                                                                                                                                                    <tr>
                                                                                                                                                                                                                                                                                                        <td>3</td>
                                                                                                                                                                                                                                                                                                            <td>All things are from one, by mediation of one...</td>
                                                                                                                                                                                                                                                                                                                <td>Singleton core, no duplicate egregores</td>
                                                                                                                                                                                                                                                                                                                </tr>
                                                                                                                                                                                                                                                                                                                <tr>
                                                                                                                                                                                                                                                                                                                    <td>4</td>
                                                                                                                                                                                                                                                                                                                        <td>The Sun is its father, the Moon its mother...</td>
                                                                                                                                                                                                                                                                                                                            <td>Elemental data modes (Fire/Water/Air/Earth)</td>
                                                                                                                                                                                                                                                                                                                            </tr>
                                                                                                                                                                                                                                                                                                                            <tr>
                                                                                                                                                                                                                                                                                                                                <td>5</td>
                                                                                                                                                                                                                                                                                                                                    <td>Father of all perfection in the whole world.</td>
                                                                                                                                                                                                                                                                                                                                        <td>Quality gates; validation before export</td>
                                                                                                                                                                                                                                                                                                                                        </tr>
                                                                                                                                                                                                                                                                                                                                        <tr>
                                                                                                                                                                                                                                                                                                                                            <td>6</td>
                                                                                                                                                                                                                                                                                                                                                <td>Its power is integral, if turned into earth.</td>
                                                                                                                                                                                                                                                                                                                                                    <td>Persist configs; write provenance.json</td>
                                                                                                                                                                                                                                                                                                                                                    </tr>
                                                                                                                                                                                                                                                                                                                                                    <tr>
                                                                                                                                                                                                                                                                                                                                                        <td>7</td>
                                                                                                                                                                                                                                                                                                                                                            <td>Separate earth from fire, subtle from gross...</td>
                                                                                                                                                                                                                                                                                                                                                                <td>
                                                                                                                                                                                                                                                                                                                                                                    <strong>Solve</strong> mode: filter/parse</td>
                                                                                                                                                                                                                                                                                                                                                                    </tr>
                                                                                                                                                                                                                                                                                                                                                                    <tr>
                                                                                                                                                                                                                                                                                                                                                                        <td>8</td>
                                                                                                                                                                                                                                                                                                                                                                            <td>Ascends to heaven and descends to earth...</td>
                                                                                                                                                                                                                                                                                                                                                                                <td>
                                                                                                                                                                                                                                                                                                                                                                                    <strong>Spiral</strong> mode: bidirectional nav</td>
                                                                                                                                                                                                                                                                                                                                                                                    </tr>
                                                                                                                                                                                                                                                                                                                                                                                    <tr>
                                                                                                                                                                                                                                                                                                                                                                                        <td>9</td>
                                                                                                                                                                                                                                                                                                                                                                                            <td>Glory of the whole world, obscurity flees...</td>
                                                                                                                                                                                                                                                                                                                                                                                                <td>
                                                                                                                                                                                                                                                                                                                                                                                                    <strong>Revelation</strong> mode: render/export</td>
                                                                                                                                                                                                                                                                                                                                                                                                    </tr>
                                                                                                                                                                                                                                                                                                                                                                                                    <tr>
                                                                                                                                                                                                                                                                                                                                                                                                        <td>10</td>
                                                                                                                                                                                                                                                                                                                                                                                                            <td>Force above all force, vanquishes every subtle thing...</td>
                                                                                                                                                                                                                                                                                                                                                                                                                <td>Resolution scaling; precision sampling</td>
                                                                                                                                                                                                                                                                                                                                                                                                                </tr>
                                                                                                                                                                                                                                                                                                                                                                                                                <tr>
                                                                                                                                                                                                                                                                                                                                                                                                                    <td>11</td>
                                                                                                                                                                                                                                                                                                                                                                                                                        <td>Thus was the world created.</td>
                                                                                                                                                                                                                                                                                                                                                                                                                            <td>Genesis preset; default scaffold</td>
                                                                                                                                                                                                                                                                                                                                                                                                                            </tr>
                                                                                                                                                                                                                                                                                                                                                                                                                            <tr>
                                                                                                                                                                                                                                                                                                                                                                                                                                <td>12</td>
                                                                                                                                                                                                                                                                                                                                                                                                                                    <td>Wonderful adaptations, of which this is the manner.</td>
                                                                                                                                                                                                                                                                                                                                                                                                                                        <td>Stylepacks & theme bindings</td>
                                                                                                                                                                                                                                                                                                                                                                                                                                        </tr>
                                                                                                                                                                                                                                                                                                                                                                                                                                        <tr>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <td>13</td>
                                                                                                                                                                                                                                                                                                                                                                                                                                                <td>Hermes Trismegistus, three parts of philosophy...</td>
                                                                                                                                                                                                                                                                                                                                                                                                                                                    <td>Trinity flag: Stone/Circuitum/Cosmogenesis</td>
                                                                                                                                                                                                                                                                                                                                                                                                                                                    </tr>
                                                                                                                                                                                                                                                                                                                                                                                                                                                    <tr>
                                                                                                                                                                                                                                                                                                                                                                                                                                                        <td>14</td>
                                                                                                                                                                                                                                                                                                                                                                                                                                                            <td>Operation of the Sun is accomplished and ended.</td>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                <td>Close/commit; finalize export</td>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                </tr>
                                                                                                                                                                                                                                                                                                                                                                                                                                                            </tbody>
                                                                                                                                                                                                                                                                                                                                                                                                                                                        </table>
                                                                                                                                                                                                                                                                                                                                                                                                                                                    </details>
                                                                                                                                                                                                                                                                                                                                                                                                                                                    <section class="card" aria-labelledby="shortcuts">
                                                                                                                                                                                                                                                                                                                                                                                                                                                        <h2 id="shortcuts">Navigation Shortcuts (No Autoplay)</h2>
                                                                                                                                                                                                                                                                                                                                                                                                                                                            <ul>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                <li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <span class="kbd">M</span> ‚Üí cycle Tablet Mode</li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <span class="kbd">E</span> ‚Üí cycle Element</li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <span class="kbd">1-8</span> ‚Üí select Octagram Node</li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <span class="kbd">ESC</span> ‚Üí return to Fool (safety exit)</li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </ul>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <p class="note">All tools respect ND-safe principles: no autoplay, no sudden motion, clear exits always visible.</p>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </section>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </div>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            (function(){
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const doc = document, win = window;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const $ = (sel, ctx=doc)=>ctx.querySelector(sel);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const $$ = (sel, ctx=doc)=>Array.from(ctx.querySelectorAll(sel));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Octagram node definitions with tools
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const nodes = {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            fool: {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            name: 'Rebecca Respawn',
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            tools: ['manifestation_engine', 'respawn_portal', 'spiral_navigator'],
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            description: "The Fool's tools focus on creative respawn, learning through mistakes, and unlimited curiosity exploration."
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            magician: {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            name: 'Agrippa Synthesizer',
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            tools: ['planetary_engine', 'elemental_synthesizer', 'orrery_navigator'],
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            description: "The Magician's tools enable elemental synthesis, planetary timing, and multi-dimensional fusion work."
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            priestess: {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            name: 'Dion Fortune',
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            tools: ['dream_oracle', 'psychic_shield', 'veil_navigator'],
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            description: "The High Priestess tools provide psychic protection, dream work, and gradual unveiling of hidden knowledge."
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            justice: {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            name: 'Stephen Skinner',
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            tools: ['geomantic_engine', 'angelic_transmitter', 'justice_scales'],
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            description: "Justice tools offer geomantic divination, angelic communication, and balanced decision-making systems."
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            hanged: {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            name: 'Frater Achad',
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            tools: ['paradox_inverter', 'daath_bridge', 'mirror_tesseract'],
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            description: "The Hanged Man's tools enable paradox work, perspective inversion, and navigation of the Abyss."
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            temperance: {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            name: 'Paul Foster Case',
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            tools: ['harmony_engine', 'color_weaver', 'cube_navigator'],
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            description: "Temperance tools focus on harmonic blending, color therapy, and navigating the Cube of Space."
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            tower: {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            name: 'Aleister Crowley',
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            tools: ['aeon_spiral', 'destruction_engine', 'paradox_summoner'],
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            description: "The Tower's tools facilitate breakthrough work, aeonic consciousness, and controlled destruction/renewal."
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            star: {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            name: 'Tara Lineage',
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            tools: ['compassion_engine', 'tara_mandala', 'healing_dome'],
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            description: "The Star's tools offer healing practices, compassion cultivation, and hope restoration systems."
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // State
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const state = {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            mode: 'spiral',
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            element: 'sun',
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            node: 'fool'
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Helpers
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            function pressToggle(btns, target, key){
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            btns.forEach(b => b.setAttribute('aria-pressed', String(b===target)));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(key==='mode'){ state.mode = target.dataset.mode; emit('codex:mode', {mode: state.mode}); }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(key==='element'){ state.element = target.dataset.element; emit('codex:element', {element: state.element}); }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(key==='node'){ state.node = target.dataset.node; updateTools(); emit('codex:node', {node: state.node}); }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            function emit(type, detail){ win.dispatchEvent(new CustomEvent(type, { detail, bubbles: true })); }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            function updateTools(){
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const node = nodes[state.node];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(!node) return;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            $('#current-archetype').textContent = node.name;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            $('#tool-description').textContent = node.description;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const toolGrid = $('#tool-grid');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            toolGrid.innerHTML = '';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            node.tools.forEach(tool => {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const btn = doc.createElement('button');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            btn.className = 'tool-btn';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            btn.dataset.tool = tool;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            btn.dataset.available = 'true';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            btn.textContent = tool.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase());
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            btn.addEventListener('click', () => {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            emit('codex:tool', {tool: tool, node: state.node});
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            console.log(`Launching ${tool} for ${node.name}`);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            toolGrid.appendChild(btn);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Wire Tablet Mode
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const modeBtns = $$('#tablet-modes button[data-mode]');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            modeBtns.forEach(btn=>{
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            btn.addEventListener('click', (e)=> pressToggle(modeBtns, e.currentTarget, 'mode'));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Wire Element Mode
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const elBtns = $$('#elements button[data-element]');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            elBtns.forEach(btn=>{
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            btn.addEventListener('click', (e)=> pressToggle(elBtns, e.currentTarget, 'element'));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Wire Node Selection
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const nodeBtns = $$('.node-btn[data-node]');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            nodeBtns.forEach(btn=>{
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            btn.addEventListener('click', (e)=> pressToggle(nodeBtns, e.currentTarget, 'node'));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Keyboard shortcuts
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            doc.addEventListener('keydown', (e)=>{
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(e.repeat) return;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(e.key==='M' || e.key==='m'){
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const order = ['solve','coagula','spiral','revelation'];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const i = (order.indexOf(state.mode)+1)%order.length;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const next = modeBtns.find(b=>b.dataset.mode===order[i]);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(next) next.click();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(e.key==='E' || e.key==='e'){
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const order = ['sun','moon','wind','earth'];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const i = (order.indexOf(state.element)+1)%order.length;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const next = elBtns.find(b=>b.dataset.element===order[i]);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(next) next.click();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(e.key==='Escape'){
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const foolBtn = nodeBtns.find(b=>b.dataset.node==='fool');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(foolBtn) foolBtn.click();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Number keys 1-8 for nodes
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const num = parseInt(e.key);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if(num >= 1 && num <= 8){
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                const nodeOrder = ['fool','magician','priestess','justice','hanged','temperance','tower','star'];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                const nodeBtn = nodeBtns.find(b=>b.dataset.node===nodeOrder[num-1]);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if(nodeBtn) nodeBtn.click();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                // Initialize
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                updateTools();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                // Announce chapel ready
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                emit('codex:chapel-ready', {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                chapel: 'emerald-tablet',
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                mode: state.mode,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                element: state.element,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                node: state.node
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                })();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </body>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </html>
